"use strict";(self.webpackChunkinterview_prep=self.webpackChunkinterview_prep||[]).push([[9241],{3905:function(e,t,a){a.d(t,{Zo:function(){return c},kt:function(){return k}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),u=p(a),k=r,d=u["".concat(s,".").concat(k)]||u[k]||m[k]||i;return a?n.createElement(d,l(l({ref:t},c),{},{components:a})):n.createElement(d,l({ref:t},c))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=u;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},3910:function(e,t,a){a.r(t),a.d(t,{assets:function(){return c},contentTitle:function(){return s},default:function(){return k},frontMatter:function(){return o},metadata:function(){return p},toc:function(){return m}});var n=a(7462),r=a(3366),i=(a(7294),a(3905)),l=["components"],o={title:"Runtime type checking in TypeScript",description:"An overview of ways to add runtime type checking to TypeScript applications",last_modified:new Date("2022-01-31T14:29:20.468Z")},s=void 0,p={unversionedId:"javascript/typescript/runtime-type-checking",id:"javascript/typescript/runtime-type-checking",title:"Runtime type checking in TypeScript",description:"An overview of ways to add runtime type checking to TypeScript applications",source:"@site/docs/javascript/typescript/runtime-type-checking.md",sourceDirName:"javascript/typescript",slug:"/javascript/typescript/runtime-type-checking",permalink:"/interview-prep/javascript/typescript/runtime-type-checking",draft:!1,tags:[],version:"current",frontMatter:{title:"Runtime type checking in TypeScript",description:"An overview of ways to add runtime type checking to TypeScript applications",last_modified:"2022-01-31T14:29:20.468Z"},sidebar:"docs",previous:{title:"Nullable types and optional parameters/properties",permalink:"/interview-prep/javascript/typescript/nullable-types-optional-parameters-properties"},next:{title:"Type guards",permalink:"/interview-prep/javascript/typescript/type-guards"}},c={},m=[{value:"Why additional type checking?",id:"why-additional-type-checking",level:2},{value:"What about type guards?",id:"what-about-type-guards",level:2},{value:"Strictness of runtime checking",id:"strictness-of-runtime-checking",level:2},{value:"Runtime type checking strategies",id:"runtime-type-checking-strategies",level:2},{value:"Manual checks in custom code",id:"manual-checks-in-custom-code",level:3},{value:"Manual checks using a validation library",id:"manual-checks-using-a-validation-library",level:3},{value:"Manually creating JSON Schemas",id:"manually-creating-json-schemas",level:3},{value:"Automatically generating JSON Schemas",id:"automatically-generating-json-schemas",level:3},{value:"Generating JSON Schemas from TypeScript code",id:"generating-json-schemas-from-typescript-code",level:4},{value:"Generating JSON Schemas from runtime types",id:"generating-json-schemas-from-runtime-types",level:4},{value:"Transpilation",id:"transpilation",level:3},{value:"Deriving static types from runtime types",id:"deriving-static-types-from-runtime-types",level:3},{value:"Decorator-based class validation",id:"decorator-based-class-validation",level:3},{value:"Frameworks integrating runtime type checking",id:"frameworks-integrating-runtime-type-checking",level:3}],u={toc:m};function k(e){var t=e.components,a=(0,r.Z)(e,l);return(0,i.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"An overview of ways to add runtime type checking to TypeScript applications"),(0,i.kt)("h2",{id:"why-additional-type-checking"},"Why additional type checking?"),(0,i.kt)("p",null,"TypeScript only performs static type checking at compile time! The generated JavaScript, which is what actually runs when you run your code, does not know anything about the types. "),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Works fine for type checking within your codebase"),(0,i.kt)("li",{parentName:"ul"},"Doesn\u2019t provide any kind of protection against malformed external input"),(0,i.kt)("li",{parentName:"ul"},"Isn't designed to express typical input validation constraints (minimum array length, string matching a certain pattern) that are about more than simple type safety",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Several of the methods below provide an easy way to specify these kinds of constraints together with the actual TypeScript types")))),(0,i.kt)("h2",{id:"what-about-type-guards"},"What about type guards?"),(0,i.kt)("p",null,"Type guards are a way to provide information to the TypeScript compiler by having the code check values at runtime."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Some degree of runtime type checking"),(0,i.kt)("li",{parentName:"ul"},"Often, type guards combine information available at runtime with information from type declarations specified in the code. The compiler will make incorrect assumptions if the actual input doesn't match those type declarations.")),(0,i.kt)("p",null,"See also ",(0,i.kt)("a",{parentName:"p",href:"/javascript/typescript/type-guards"},"Type guards")),(0,i.kt)("h2",{id:"strictness-of-runtime-checking"},"Strictness of runtime checking"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Needs to be at least as strict as compile-time checking (otherwise, we lose the guarantees that the compile-time checking provides)"),(0,i.kt)("li",{parentName:"ul"},"Can be more strict if desired (require age to be >= 0, require string to match a regex)",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Note that the TypeScript compiler will not be able to rely on such information")))),(0,i.kt)("h2",{id:"runtime-type-checking-strategies"},"Runtime type checking strategies"),(0,i.kt)("h3",{id:"manual-checks-in-custom-code"},"Manual checks in custom code"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Flexible"),(0,i.kt)("li",{parentName:"ul"},"Can be tedious and error-prone"),(0,i.kt)("li",{parentName:"ul"},"Can easily get out of sync with actual code")),(0,i.kt)("h3",{id:"manual-checks-using-a-validation-library"},"Manual checks using a validation library"),(0,i.kt)("p",null,"Example validation library: ",(0,i.kt)("a",{href:"https://joi.dev/",target:"_blank",rel:"nofollow noopener noreferrer"},"joi ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},'import Joi from "joi"\n\nconst schema = Joi.object({\n    firstName: Joi.string().required(),\n    lastName: Joi.string().required(),\n    age: Joi.number().integer().min(0).required(),\n});\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Flexible"),(0,i.kt)("li",{parentName:"ul"},"Easy to write"),(0,i.kt)("li",{parentName:"ul"},"Can easily get out of sync with actual code")),(0,i.kt)("p",null,"Note: there are some very similar libraries than can derive TypeScript types from the runtime type definitions (",(0,i.kt)("a",{parentName:"p",href:"#deriving-static-types-from-runtime-types"},"see below"),")"),(0,i.kt)("h3",{id:"manually-creating-json-schemas"},"Manually creating JSON Schemas"),(0,i.kt)("p",null,"Example JSON Schema:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "$schema": "http://json-schema.org/draft-07/schema#",\n  "required": [\n    "firstName",\n    "lastName",\n    "age"\n  ],\n  "properties": {\n    "firstName": {\n      "type": "string"\n    },\n    "lastName": {\n      "type": "string"\n    },\n    "age": {\n      "type": "integer",\n      "minimum": 0\n    }\n  }\n}\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Standard format, lots of libraries available for validation ...",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Example library for validation: ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/ajv",target:"_blank",rel:"nofollow noopener noreferrer"},"ajv ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))))),(0,i.kt)("li",{parentName:"ul"},"JSON: easy to store and share"),(0,i.kt)("li",{parentName:"ul"},"Can become very verbose and can be tedious to create by hand"),(0,i.kt)("li",{parentName:"ul"},"Can easily get out of sync with actual code")),(0,i.kt)("h3",{id:"automatically-generating-json-schemas"},"Automatically generating JSON Schemas"),(0,i.kt)("h4",{id:"generating-json-schemas-from-typescript-code"},"Generating JSON Schemas from TypeScript code"),(0,i.kt)("p",null,"Most robust library at the moment: ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/ts-json-schema-generator",target:"_blank",rel:"nofollow noopener noreferrer"},"ts-json-schema-generator ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," (for some alternatives, see ",(0,i.kt)("a",{href:"https://github.com/vega/ts-json-schema-generator/issues/101",target:"_blank",rel:"nofollow noopener noreferrer"},"this discussion ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"}))),")"),(0,i.kt)("p",null,"Example input, including specific constraints that are stricter than TS type checking:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"interface Person {\n    /** @pattern ^[A-Z][a-z]+$  */\n    firstName: string;\n\n    lastName: string;\n\n    /**\n     * @asType integer\n     * @minimum 0\n     */\n    age: number;\n}\n")),(0,i.kt)("p",null,"Example output (with default options):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "$ref": "#/definitions/Person",\n  "$schema": "http://json-schema.org/draft-07/schema#",\n  "definitions": {\n    "Person": {\n      "additionalProperties": false,\n      "properties": {\n        "age": {\n          "minimum": 0,\n          "type": "integer"\n        },\n        "firstName": {\n          "pattern": "^[A-Z][a-z]+$",\n          "type": "string"\n        },\n        "lastName": {\n          "type": "string"\n        }\n      },\n      "required": [\n        "firstName",\n        "lastName",\n        "age"\n      ],\n      "type": "object"\n    }\n  }\n}\n')),(0,i.kt)("p",null,"Benefits compared to manually creating JSON Schemas:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Single source of truth"),(0,i.kt)("li",{parentName:"ul"},"You can use scripts to make sure generated schemas and code stay in sync")),(0,i.kt)("h4",{id:"generating-json-schemas-from-runtime-types"},"Generating JSON Schemas from runtime types"),(0,i.kt)("p",null,"For some of the runtime type checking libraries mentioned in this note, it's possible to automatically generate JSON Schemas based on the defined runtime types. Some examples:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("a",{href:"https://joi.dev/",target:"_blank",rel:"nofollow noopener noreferrer"},"joi ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," library (see ",(0,i.kt)("a",{parentName:"li",href:"#manual-checks-using-a-validation-library"},"Manual checks using a validation library"),")",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Can use ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/joi-to-json",target:"_blank",rel:"nofollow noopener noreferrer"},"joi-to-json ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))))),(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/zod",target:"_blank",rel:"nofollow noopener noreferrer"},"zod ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," library (see ",(0,i.kt)("a",{parentName:"li",href:"#deriving-static-types-from-runtime-types"},"Deriving static types from runtime types"),")",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Can use ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/zod-to-json-schema",target:"_blank",rel:"nofollow noopener noreferrer"},"zod-to-json-schema ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))),(0,i.kt)("li",{parentName:"ul"},"Bonus points because it allows deriving static types from runtime types"))),(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/@sinclair/typebox",target:"_blank",rel:"nofollow noopener noreferrer"},"@sinclair/typebox ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," library (see ",(0,i.kt)("a",{parentName:"li",href:"#deriving-static-types-from-runtime-types"},"Deriving static types from runtime types"),")",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"JSON Schema is immediately generated in the background"),(0,i.kt)("li",{parentName:"ul"},"Runtime type checking is implemented through generated JSON Schema"),(0,i.kt)("li",{parentName:"ul"},"Bonus points because it allows deriving static types from runtime types"))),(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/class-validator",target:"_blank",rel:"nofollow noopener noreferrer"},"class-validator ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," library (see ",(0,i.kt)("a",{parentName:"li",href:"#decorator-based-class-validation"},"Decorator-based class validation"),")",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Can use ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/class-validator-jsonschema",target:"_blank",rel:"nofollow noopener noreferrer"},"class-validator-jsonschema ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))),(0,i.kt)("li",{parentName:"ul"},"Bonus points because it integrates static and runtime type checking")))),(0,i.kt)("h3",{id:"transpilation"},"Transpilation"),(0,i.kt)("p",null,"Example library: ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/ts-runtime",target:"_blank",rel:"nofollow noopener noreferrer"},"ts-runtime ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Processes code"),(0,i.kt)("li",{parentName:"ul"},"Transpiles code into equivalent code with built-in runtime type checking")),(0,i.kt)("p",null,"Example code:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},'interface Person {\n    firstName: string;\n    lastName: string;\n    age: number;\n}\n\nconst test: Person = {\n    firstName: "Foo",\n    lastName: "Bar",\n    age: 55\n}\n')),(0,i.kt)("p",null,"Example transpiled code"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},'import t from "ts-runtime/lib";\n\nconst Person = t.type(\n    "Person",\n    t.object(\n        t.property("firstName", t.string()),\n        t.property("lastName", t.string()),\n        t.property("age", t.number())\n    )\n);\n\nconst test = t.ref(Person).assert({\n    firstName: "Foo",\n    lastName: "Bar",\n    age: 55\n});\n')),(0,i.kt)("p",null,"Problem: no control over where type checking happens (we only need runtime type checks at the boundaries!)"),(0,i.kt)("p",null,"Note: Library is still in an experimental stage and not recommended for production use!"),(0,i.kt)("h3",{id:"deriving-static-types-from-runtime-types"},"Deriving static types from runtime types"),(0,i.kt)("p",null,"Example library: ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/yup",target:"_blank",rel:"nofollow noopener noreferrer"},"yup ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"You define runtime types"),(0,i.kt)("li",{parentName:"ul"},"TypeScript infers the corresponding static types from these")),(0,i.kt)("p",null,"Example runtime type:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},'import { object, string, number, InferType } from "yup";\n\nconst personSchema = object({\n    firstName: string().required(),\n    lastName: string().required(),\n    age: number().integer().positive().required(),\n});\n')),(0,i.kt)("p",null,"Extracting the corresponding static TypeScript type:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"type Person = InferType<typeof personSchema>;\n")),(0,i.kt)("p",null,"Equivalent to:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"type Person = {\n    firstName: string;\n    lastName: string;\n    age: number;\n}\n")),(0,i.kt)("p",null,"Benefits/drawbacks:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"No possibility for types to get out of sync"),(0,i.kt)("li",{parentName:"ul"},"You need to define your types as ",(0,i.kt)("inlineCode",{parentName:"li"},"yup")," runtime types, not ideal if you want to validate input against a class definition",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"One way to handle this: define a ",(0,i.kt)("inlineCode",{parentName:"li"},"yup")," type matching the class, create an interface based on the type alias obtained from ",(0,i.kt)("inlineCode",{parentName:"li"},"yup")," and then make the class implement the interface. This way, TypeScript helps you to keep the ",(0,i.kt)("inlineCode",{parentName:"li"},"yup")," type in sync with the class, although not all cases are covered (for example, you still need to remember to update the ",(0,i.kt)("inlineCode",{parentName:"li"},"yup")," type when adding properties to the class)."),(0,i.kt)("li",{parentName:"ul"},"Probably, decorator-based class validation is a better approach in this case (",(0,i.kt)("a",{parentName:"li",href:"#decorator-based-class-validation"},"see below"),")"))),(0,i.kt)("li",{parentName:"ul"},"Harder to share static types (e.g. between backend and frontend) because they are inferred from ",(0,i.kt)("inlineCode",{parentName:"li"},"yup")," types")),(0,i.kt)("p",null,"Some alternative libraries (",(0,i.kt)("a",{href:"https://www.npmtrends.com/@sinclair/typebox-vs-io-ts-vs-ow-vs-runtypes-vs-yup-vs-zod",target:"_blank",rel:"nofollow noopener noreferrer"},"compare their popularity ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"}))),"):"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/ow",target:"_blank",rel:"nofollow noopener noreferrer"},"ow ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," library"),(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/io-ts",target:"_blank",rel:"nofollow noopener noreferrer"},"io-ts ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," library",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Built on ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/fp-ts",target:"_blank",rel:"nofollow noopener noreferrer"},"fp-ts ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"}))),", a library for typed functional programming in TypeScript"),(0,i.kt)("li",{parentName:"ul"},"Can be confusing if you're not familiar with functional programming concepts"),(0,i.kt)("li",{parentName:"ul"},"Provides more strict static type checking than standard TypeScript",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"For example, if you define a property ",(0,i.kt)("inlineCode",{parentName:"li"},"age")," that must be an integer, the inferred TypeScript type will not have ",(0,i.kt)("inlineCode",{parentName:"li"},"age: number")," but instead it will have ",(0,i.kt)("inlineCode",{parentName:"li"},"age: t.Branded<number, t.IntBrand>"),". Using a value of that type is straightforward, since you can use it anywhere you can use a ",(0,i.kt)("inlineCode",{parentName:"li"},"number"),". In order to obtain a value of the type, you must either pass through the runtime type checking (recommended) or bypass TypeScript type checking altogether with something like ",(0,i.kt)("inlineCode",{parentName:"li"},"const age: t.Branded<number, t.IntBrand> = 1 as any"),"  (might make sense for test data and hardcoded values)."),(0,i.kt)("li",{parentName:"ul"},"The extra type safety may or may not be worth the extra boilerplate and complexity for your use case"))))),(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/zod",target:"_blank",rel:"nofollow noopener noreferrer"},"zod ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," library"),(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/runtypes",target:"_blank",rel:"nofollow noopener noreferrer"},"runtypes ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," library"),(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/@sinclair/typebox",target:"_blank",rel:"nofollow noopener noreferrer"},"@sinclair/typebox ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," library",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Generates in-memory JSON Schemas in the background"),(0,i.kt)("li",{parentName:"ul"},"You need another library (like ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/ajv",target:"_blank",rel:"nofollow noopener noreferrer"},"ajv ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"}))),") for the actual validation")))),(0,i.kt)("h3",{id:"decorator-based-class-validation"},"Decorator-based class validation"),(0,i.kt)("p",null,"Example library: ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/class-validator",target:"_blank",rel:"nofollow noopener noreferrer"},"class-validator ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Uses decorators on class properties"),(0,i.kt)("li",{parentName:"ul"},"Very similar to Java\u2019s JSR-380 Bean Validation 2.0 (implemented by, for example, Hibernate Validator)",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Part of a family of Java EE-like libraries that also includes ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/typeorm",target:"_blank",rel:"nofollow noopener noreferrer"},"typeorm ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," (ORM, similar to Java\u2019s JPA) and ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/routing-controllers",target:"_blank",rel:"nofollow noopener noreferrer"},"routing-controllers ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," (similar to Java\u2019s JAX-RS for defining APIs)")))),(0,i.kt)("p",null,"Example code:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},'import { plainToClass } from "class-transformer";\n\nimport { \n    validate, IsString, IsInt, Min \n} from "class-validator";\n\nclass Person {\n    @IsString()\n    firstName: string;\n\n    @IsString()\n    lastName: string;\n\n    @IsInt()\n    @Min(0)\n    age: number;\n}\n\nconst input: any = {\n    firstName: "Foo",\n    age: -1\n};\n\nconst inputAsClassInstance = plainToClass(\n    Person, input as Person\n);\n\nvalidate(inputAsClassInstance).then(errors => {\n    // handle errors if needed\n});\n')),(0,i.kt)("p",null,"Benefits/drawbacks:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"No possibility for types to get out of sync"),(0,i.kt)("li",{parentName:"ul"},"Good for validating against a class definition"),(0,i.kt)("li",{parentName:"ul"},"Not ideal if you want to validate input against an interface",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"One way to handle this: define a class implementing the interface and add the decorators there. This way, TypeScript helps you to keep the class in sync with the interface, although not all cases are covered (for example, you still need to remember to update the class type when removing properties from the interface)")))),(0,i.kt)("p",null,"Note: class-validator needs actual class instances to work on"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Here, we used its sister library ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/class-transformer",target:"_blank",rel:"nofollow noopener noreferrer"},"class-transformer ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," to transform our plain input into an actual ",(0,i.kt)("inlineCode",{parentName:"li"},"Person")," instance",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"The transformation in itself does not perform any kind of type checking!")))),(0,i.kt)("h3",{id:"frameworks-integrating-runtime-type-checking"},"Frameworks integrating runtime type checking"),(0,i.kt)("p",null,"Some example frameworks:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("a",{href:"https://nestjs.com/",target:"_blank",rel:"nofollow noopener noreferrer"},"NestJS ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," framework",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Integrates with ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/class-validator",target:"_blank",rel:"nofollow noopener noreferrer"},"class-validator ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," for runtime type checking (",(0,i.kt)("a",{href:"https://docs.nestjs.com/techniques/validation",target:"_blank",rel:"nofollow noopener noreferrer"},"doc ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"}))),")"))),(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("a",{href:"https://tsoa-community.github.io/docs/",target:"_blank",rel:"nofollow noopener noreferrer"},"tsoa ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," framework",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Automatically generates OpenAPI specs from your code"),(0,i.kt)("li",{parentName:"ul"},"Uses JSON Schema under the hood to provide runtime type checking"))),(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("a",{href:"https://typegraphql.com",target:"_blank",rel:"nofollow noopener noreferrer"},"type-graphql ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," framework",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Automatically generates GraphQL SDL from your code"),(0,i.kt)("li",{parentName:"ul"},"Integrates with ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/class-validator",target:"_blank",rel:"nofollow noopener noreferrer"},"class-validator ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," for runtime type checking (",(0,i.kt)("a",{href:"https://typegraphql.com/docs/validation.html",target:"_blank",rel:"nofollow noopener noreferrer"},"doc ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"}))),")"))),(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/routing-controllers",target:"_blank",rel:"nofollow noopener noreferrer"},"routing-controllers ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," framework",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Integrates with ",(0,i.kt)("a",{href:"https://www.npmjs.com/package/class-validator",target:"_blank",rel:"nofollow noopener noreferrer"},"class-validator ",(0,i.kt)("svg",{class:"embedded-fa-icon"},(0,i.kt)("use",{href:"#external-link-alt"})))," for runtime type checking")))))}k.isMDXComponent=!0}}]);